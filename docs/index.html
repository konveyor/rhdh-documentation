<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RHDH Setup Guide</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3 {
            color: #333;
        }
        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
        code {
            font-family: monospace;
            background-color: #f5f5f5;
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>Backstage RHDH Plugin Configuration Guide</h1>
    
    <p>This comprehensive guide outlines the steps to configure, deploy, and troubleshoot the MTA plugin for Red Hat Developer Hub (RHDH).</p>
    
    <h2>Table of Contents</h2>
    <ol>
        <li><a href="#cluster-access">Cluster Access</a></li>
        <li><a href="#mta-tackle-setup">MTA/Tackle Setup</a></li>
        <li><a href="#rhdh-operator">RHDH Operator Deployment</a></li>
        <li><a href="#configmaps">Configmaps and Secrets</a></li>
        <li><a href="#keycloak">Keycloak Client Setup</a></li>
        <li><a href="#plugin-deployment">Plugin Deployment</a></li>
        <li><a href="#troubleshooting">Troubleshooting</a></li>
    </ol>
    
    <h2 id="cluster-access">1. Get Access to Your Cluster</h2>
    <p>The first step is to <strong>log in to your cluster</strong>.</p>
    <ul>
        <li>Run the following command:</li>
    </ul>
    <pre><code>oc login --token=&lt;your-token&gt; --server=&lt;your-server-url&gt;</code></pre>
    
    <h2 id="mta-tackle-setup">2. MTA / Tackle Setup Process</h2>
    <p>You need an MTA instance running in your cluster. For upstream MTA (Tackle), follow these instructions:</p>
    <ul>
        <li><strong>Create a Tackle instance</strong> in the cluster:</li>
    </ul>
    <pre><code>kubectl apply -f https://raw.githubusercontent.com/konveyor/tackle2-operator/main/tackle-k8s.yaml</code></pre>
    <ul>
        <li><em>Note: This may take a moment for the operator to spin up</em>.</li>
        <li>Once the Tackle instance is running, <strong>create a Tackle Custom Resource (CR) to configure it</strong>:</li>
    </ul>
    <pre><code>cat << EOF | kubectl apply -f -
kind: Tackle
apiVersion: tackle.konveyor.io/v1alpha1
metadata:
  name: tackle
  namespace: konveyor-tackle
spec:
  feature_auth_required: true
EOF</code></pre>
    <ul>
        <li><em>Alternatively, you can use the downstream MTA, with versions up to 7.2.2 supported. Version 7.3 requires an update for RHBK</em>.</li>
    </ul>
    
    <h3>MTA Plugin Configuration</h3>
    <ul>
        <li><strong>Configure the MTA plugin URL</strong>: You will need the URL for the Tackle instance. This URL must be added to the <code>app-config</code> configmap (e.g., <code>app-config-rhdh.example.yaml</code>) under the <code>mta</code> key. <strong>Be sure to include the <code>http://</code> or <code>https://</code> prefix</strong>.</li>
        <li>The <code>app-config</code> configmap also contains the <code>mta</code> key, which holds configurations for MTA resources, including:
            <ul>
                <li><code>url</code>: The URL of the MTA instance</li>
                <li><code>backendPluginRoot</code>: Root URL for the MTA backend plugin</li>
                <li><code>version</code>: Version of the backend plugin</li>
            </ul>
        </li>
    </ul>
    
    <p><a href="https://github.com/konveyor/rhdh-documentation/blob/main/index.md">View the full documentation on GitHub</a></p>
</body>
</html>
